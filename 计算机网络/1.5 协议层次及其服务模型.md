### 1.5.1 分层的体系结构

利用分层的体系结构，我们可以讨论一个定义良好的、大而复杂系统的特定部分。这种简化本身由于提供模块化而具有很高价值，这使实现由层所提供的服务易于改变。只要该层对其上面的层提供相同的服务，并且使用来自下面层次的相同服务，当某层的实现变化时，该系统的其余部分保持不变。

#### 1 协议分层

为了给网络协议的设计提供一个结构，网络设计者以**分层**（layer）的方式组织协议以及实现这些协议的网络硬件和软件。每个协议属于这些层次之一。

某层向它的上一层提供**服务**（service），即该层的**服务模型**（service model）。每层通过在该层中执行某些动作或使用直接下层的服务来提供服务。

一个协议层能够用软件、硬件或两者的结合来实现。应用层和传输层几乎总是在端系统中用软件实现的，而物理层、数据链路层通常是实现在与给定链路相联系的网络接口卡中（硬件中）。网络层经常是硬件和软件实现的混合体。

各层的所有协议被称为**协议栈**（protocol stack），因特网的协议栈由5个层次组成：物理层、链路层、网络层、运输层和应用层。

（1）应用层

位于应用层的信息分组称为**报文**（message）     
应用层是网络应用程序及它们的应用层协议存留的地方。包括**HTTP**（提供web文档的请求和传送）、**SMTP**（提供电子邮件报文的传输）、**FTP**（提供两个端系统之间的文件传送）、**DNS**（域名系统）等。应用层协议分布在多个端系统上，一个端系统中的应用程序使用协议与另一个端系统中的应用程序交换信息的分组。

（2）运输层

运输层分组称为**报文段**（segment）   
因特网的运输层在应用程序端点之间传送应用层报文。在因特网中，有两个运输协议，即**TCP**、**UDP**。   
TCP向它的应用程序提供面向连接的服务，包括确保传递的可靠性、流量控制及拥塞控制等。   
UDP协议向它的应用程序提供无连接服务，UDP是一种不提供不必要服务的服务，没有可靠性，没有流量控制、拥塞控制等。   


（3）网络层

网络层分组称为**数据报**（datagram）   
因特网的网络层包括IP协议，该协议定义了在数据报中的各个字段以及端系统和路由器如何作用于这些字段。因特网的网路层也包括决定路由的路由选择协议，它使数据报根据该路由从源传输到目的地。

（4）链路层

链路层分组称为**帧**（frame）   
链路层将整个帧从一个网络元素（结点）移动到邻近的网络元素（结点）。

（5）物理层

物理层将帧中的一个一个比特从一个结点移动到下一个结点。

#### 2 OSI分层

此处忽略。

### 1.5.2 封装（encapsulation）

在发送主机端，一个**应用层报文**（application-layer message）被传输至运输层。在最简单的情况下，运输层收取到报文并附上附加信息（运输层首部信息），该首部将被接收端的运输层使用。应用层报文和运输层首部信息一道构成了**运输层报文段**（transport-layer segment）。运输层报文因此封装了应用层报文。运输层则向网路层传递该报文段，网路层增加了如源和目的端系统地址等网路层首部信息，产生了**网络层数据报**（network-layer datagram）。该数据报接下来被传递给链路层，链路层增加它自己的链路层首部信息并创建**链路层帧**（link-layer frame）。所以，我们看到在每一层，一个分组具有两种类型的字段；**首部字段**和**有效载荷字段**（payload field）。有效载荷通常是来自于上一层的分组。

实际封装的过程能够比前面描述的更为复杂，例如，一个大报文可能被划分为多个运输层报文段（报文段每个可能被划分为多个网络层数据报）。在接收端，则必须从连续的数据报中重构这样一个报文段。

